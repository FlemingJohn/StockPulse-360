sequenceDiagram
    participant Sched as Scheduler/Cron
    participant Script as check_all_tables.py
    participant DB as Snowflake DB
    participant Notifier as alert_sender.py
    participant Ext as Email/Slack

    Note over Sched, Script: Dual-Mode Scheduling
    
    par Immediate Mode (Every 5 Mins)
        Sched->>Script: Trigger "alert_sender.py --mode immediate"
        activate Script
        Script->>DB: Query OUT_OF_STOCK items
        DB-->>Script: Return critical items
        
        alt Items Found
            Script->>Notifier: Send Urgent Alert
            activate Notifier
            Notifier->>Ext: Dispatch Immediate Notification
            Ext-->>Notifier: Success
            Notifier-->>Script: Done
            deactivate Notifier
        end
        deactivate Script
        
    and Daily Mode (8:00 AM)
        Sched->>Script: Trigger "alert_sender.py --mode daily"
        activate Script
        Script->>DB: Query WARNING & CRITICAL items
        DB-->>Script: Return all at-risk items
        
        alt Items Found
            Script->>Notifier: Compile Morning Report
            activate Notifier
            Notifier->>Ext: Dispatch Summary Email/Slack
            Ext-->>Notifier: Success
            Notifier-->>Script: Done
            deactivate Notifier
        end
        deactivate Script
    end
